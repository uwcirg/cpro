<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>DHAIR2: SurveysController Class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
    <li>
      <form action="../../search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>SurveysController Class Reference</h1><!-- doxytag: class="SurveysController" --><!-- doxytag: inherits="AppController" --><div class="dynheader">
Inheritance diagram for SurveysController:</div>
<div class="dynsection">

<p><center><img src="../../dd/d48/classSurveysController.png" usemap="#SurveysController_map" border="0" alt=""></center>
<map name="SurveysController_map">
</map>
</div>

<p>
<a href="../../d8/dd5/classSurveysController-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="cee794bb2e2a6819494505e3edbd8aaa"></a><!-- doxytag: member="SurveysController::beforeRender" ref="cee794bb2e2a6819494505e3edbd8aaa" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>beforeRender</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#300cb7644be015c70e383b1c87d3193b">beforeFilter</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="408d75dfdc6b7c712552319bf76af2ec"></a><!-- doxytag: member="SurveysController::index" ref="408d75dfdc6b7c712552319bf76af2ec" args="($sessionStart=null)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>index</b> ($sessionStart=null)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#bdad5763b1d8cc8398e66dc57832cbac">new_session</a> ($project_id=null)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="2cdc21ba7809daeafbd471e76ca56edd"></a><!-- doxytag: member="SurveysController::break_session" ref="2cdc21ba7809daeafbd471e76ca56edd" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>break_session</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#2d8651b9c0b530de63dba85ba2ee39b4">restart</a> ($session_id, $question_id=null)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#858e9407157942ba1bde558c8f872f84">show</a> ($page_id, $iteration=0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#7d78cb81b277d0667aafd27bc26e70a1">next_page</a> ($page_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="c7945c00fffc5ca029489c6b108c064e"></a><!-- doxytag: member="SurveysController::previous_page" ref="c7945c00fffc5ca029489c6b108c064e" args="($page_id, $iteration=0)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>previous_page</b> ($page_id, $iteration=0)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#51528625c08d1c3aa178a0256be5409d">_interrupt_survey</a> ($page_id, $new_page_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#3988251811d83e508557561e97cffc65">_evaluate_alert</a> ($page_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#a4c8e61014eb3455d7ec11cf59343e4d">log_click_to_external_resource</a> ($externalUrl)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#f00de2d23895025ec459fde2950cfaaf">log_teaching_tip_expansion</a> ($tipQuestionStem)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="822047eebffb8b57fc8f6e73cdc3250b"></a><!-- doxytag: member="SurveysController::print_csv_line" ref="822047eebffb8b57fc8f6e73cdc3250b" args="($array)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>print_csv_line</b> ($array)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a88d92fddfd859da40b7e51421ead9f8"></a><!-- doxytag: member="SurveysController::summary_csv" ref="a88d92fddfd859da40b7e51421ead9f8" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>summary_csv</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#be95564d4dfe8737ddd05c1840a9dad1">summary</a> ($project_id, $language= 'all', $textOnly= 'false')</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#a22ddcfdc027878ae00fdb4b0e7c6023">generate_se_test</a> ($patientId, $appointment_id=null, $select_option= 'max')</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="ab9e9d9949bf1264974ae8359a5464d6"></a><!-- doxytag: member="SurveysController::answer" ref="ab9e9d9949bf1264974ae8359a5464d6" args="($question_id)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>answer</b> ($question_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#9ac76dde3c98daf38536871c16be0ecc">questionnaires</a> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#27532bb1975d59e2f856154e6d0a5828">questionnaire</a> ($qr_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#b00016d5cf4d3964ef0c5e5e70ceb8a8">complete</a> ($nth=1)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="0e88ea46900ac53ed09c0caf86d49677"></a><!-- doxytag: member="SurveysController::overview" ref="0e88ea46900ac53ed09c0caf86d49677" args="()" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>overview</b> ()</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="99d6cbf172fe1872174298215870c566"></a><!-- doxytag: member="SurveysController::edit_project" ref="99d6cbf172fe1872174298215870c566" args="($project_id)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>edit_project</b> ($project_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="994298fcd17190c2f75df507eead4c2f"></a><!-- doxytag: member="SurveysController::reopen_test_session" ref="994298fcd17190c2f75df507eead4c2f" args="($sessionId)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>reopen_test_session</b> ($sessionId)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="f5b7c68200d150866335b3f4b72593a2"></a><!-- doxytag: member="SurveysController::finish_test_session" ref="f5b7c68200d150866335b3f4b72593a2" args="($sessionId)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>finish_test_session</b> ($sessionId)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#b38ccf200e576350fe9707582c35fd39">copy_questionnaire</a> ($qnrId)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="6ea1159d438af1210dc7ee8c4e768331"></a><!-- doxytag: member="SurveysController::edit" ref="6ea1159d438af1210dc7ee8c4e768331" args="($id=null, $table=null, $text=null)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>edit</b> ($id=null, $table=null, $text=null)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="960d5c51346574b0e4b0c7e17dd446e4"></a><!-- doxytag: member="SurveysController::getSurveyHome" ref="960d5c51346574b0e4b0c7e17dd446e4" args="($project=null)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>getSurveyHome</b> ($project=null)</td></tr>

<tr><td colspan="2"><br><h2>Public Attributes</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#1fe005a75887d7ef4d9ff6f18ed110be">NO_ASSOCIATED_RESULTS</a> = &quot;None&quot;</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><b>$uses</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><b>$components</b></td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="e883fcab799cedb816e994b85ae4fc1a"></a><!-- doxytag: member="SurveysController::$helpers" ref="e883fcab799cedb816e994b85ae4fc1a" args="" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>$helpers</b> = array(&quot;InstanceSpecifics&quot;)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d48/classSurveysController.html#a716ec94256bed5a7d767ec7ba458c9a">$surveyPatientId</a></td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Copyright 2013 University of Washington, School of Nursing. <a href="http://opensource.org/licenses/BSD-3-Clause">http://opensource.org/licenses/BSD-3-Clause</a> <hr><h2>Member Function Documentation</h2>
<a class="anchor" name="300cb7644be015c70e383b1c87d3193b"></a><!-- doxytag: member="SurveysController::beforeFilter" ref="300cb7644be015c70e383b1c87d3193b" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::beforeFilter           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
foreach ($this-&gt;patient['Appointment'] as $appointment){ if ($appointment['datetime'] &lt; currentGmt()){ $nextAppointment = $appointment; } else break; } 
</div>
</div><p>
<a class="anchor" name="bdad5763b1d8cc8398e66dc57832cbac"></a><!-- doxytag: member="SurveysController::new_session" ref="bdad5763b1d8cc8398e66dc57832cbac" args="($project_id=null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::new_session           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>project_id</em> = <code>null</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
$nextAppointment = $this-&gt;Appointment-&gt;getNextAppointment($this-&gt;surveyPatientId); 
</div>
</div><p>
<a class="anchor" name="2d8651b9c0b530de63dba85ba2ee39b4"></a><!-- doxytag: member="SurveysController::restart" ref="2d8651b9c0b530de63dba85ba2ee39b4" args="($session_id, $question_id=null)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::restart           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>session_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>question_id</em> = <code>null</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Restart a session, optionally at a particular question <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>session_id</em>&nbsp;</td><td>Session to restart </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>question_id</em>&nbsp;</td><td><a class="el" href="../../dd/d6c/classQuestion.html">Question</a> to restart at. If null, start at the last question answered </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="858e9407157942ba1bde558c8f872f84"></a><!-- doxytag: member="SurveysController::show" ref="858e9407157942ba1bde558c8f872f84" args="($page_id, $iteration=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::show           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>page_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>iteration</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
show a survey page<p>
Notes on some tricky pages: TEACHING_TIPS_PAGE (eg #315) has substitution fxn %(TEACHING_TIPS) if all tips have been displayed, redirect to surveys/index if this tip has already been displayed, $this-&gt;controller-&gt;redirect('show/' . TEACHING_TIPS_PAGE); else $this-&gt;controller-&gt;render('teaching_tips'); next button links to 'show/' . TEACHING_TIPS_PAGE 
<p>
//FIXME removed because items and question are now many : many, and this functionality not used enough to warrant an update get the associated subscale id, if any $item = $this-&gt;Item-&gt;findByQuestion($question['id']);<p>
if (!empty($item)) { $subscaleId = $item['Item']['subscale_id']; }<p>
if (!Configureread('isProduction') &amp;&amp; $this-&gt;session['Patient']['test_flag'] &amp;&amp; $this-&gt;SurveySession-&gt;finished($this-&gt;session['SurveySession'])) { if (!empty($subscaleId)) { $this-&gt;set('resultsLink', "/results/show/$subscaleId"); } else { $this-&gt;set('resultsLink', self::NO_ASSOCIATED_RESULTS); } } 
</div>
</div><p>
<a class="anchor" name="7d78cb81b277d0667aafd27bc26e70a1"></a><!-- doxytag: member="SurveysController::next_page" ref="7d78cb81b277d0667aafd27bc26e70a1" args="($page_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::next_page           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>page_id</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>

<p>
if ($this-&gt;Session-&gt;check(self::TAKING_SURVEY_AS)) { taking a survey as a patient, go back to the patient edit $this-&gt;Session-&gt;delete(self::TAKING_SURVEY_AS); $this-&gt;Session-&gt;delete("session_id"); $this-&gt;redirect('/patients/edit/' . $this-&gt;surveyPatientId); } else { $this-&gt;redirect("/surveys"); } 
</div>
</div><p>
<a class="anchor" name="51528625c08d1c3aa178a0256be5409d"></a><!-- doxytag: member="SurveysController::_interrupt_survey" ref="51528625c08d1c3aa178a0256be5409d" args="($page_id, $new_page_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::_interrupt_survey           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>page_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>new_page_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Evaluated for all survey next/previous button clicks: if you want to interrupt, return the url to send the user to 
</div>
</div><p>
<a class="anchor" name="3988251811d83e508557561e97cffc65"></a><!-- doxytag: member="SurveysController::_evaluate_alert" ref="3988251811d83e508557561e97cffc65" args="($page_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::_evaluate_alert           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>page_id</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Checks for alerts for this page and evaluates necessary instruments. Returns alert message array (true) if it should be shown, else false 
</div>
</div><p>
<a class="anchor" name="a4c8e61014eb3455d7ec11cf59343e4d"></a><!-- doxytag: member="SurveysController::log_click_to_external_resource" ref="a4c8e61014eb3455d7ec11cf59343e4d" args="($externalUrl)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::log_click_to_external_resource           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>externalUrl</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Ajax method Really just used for writing entries to the logs table 
</div>
</div><p>
<a class="anchor" name="f00de2d23895025ec459fde2950cfaaf"></a><!-- doxytag: member="SurveysController::log_teaching_tip_expansion" ref="f00de2d23895025ec459fde2950cfaaf" args="($tipQuestionStem)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::log_teaching_tip_expansion           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>tipQuestionStem</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Ajax method Really just used for writing entries to the logs table 
</div>
</div><p>
<a class="anchor" name="be95564d4dfe8737ddd05c1840a9dad1"></a><!-- doxytag: member="SurveysController::summary" ref="be95564d4dfe8737ddd05c1840a9dad1" args="($project_id, $language= 'all', $textOnly= 'false')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::summary           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>project_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>language</em> = <code>'all'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>textOnly</em> = <code>'false'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Project/Survey editor 
</div>
</div><p>
<a class="anchor" name="a22ddcfdc027878ae00fdb4b0e7c6023"></a><!-- doxytag: member="SurveysController::generate_se_test" ref="a22ddcfdc027878ae00fdb4b0e7c6023" args="($patientId, $appointment_id=null, $select_option= 'max')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::generate_se_test           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>patientId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>appointment_id</em> = <code>null</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>select_option</em> = <code>'max'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$appointment_id</em>&nbsp;</td><td>//TODO </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$select_option</em>&nbsp;</td><td>Which options to select; can be either: min, max, rand, median, none //TODO </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$checkbox_option</em>&nbsp;</td><td>Which check boxes to select; can be either: min, max, rand, all, none </td></tr>
  </table>
</dl>

<p>
Why do we need session record? because conditionality needs session reference Why do we need patient record? to create session, and because some conditionality fxns expect $this-&gt;patient to be set<p>
Look for any T session w/ same type, if can't find one, create it<p>
case "rand": //TODO needs impl $select = sizeof($question["Option"]); break; case "med": //TODO needs impl $select = sizeof($question["Option"]); break; case "none": //TODO wontwork if some already selected $select = sizeof($question["Option"]) + 1; break; 
</div>
</div><p>
<a class="anchor" name="9ac76dde3c98daf38536871c16be0ecc"></a><!-- doxytag: member="SurveysController::questionnaires" ref="9ac76dde3c98daf38536871c16be0ecc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::questionnaires           </td>
          <td>(</td>
          <td class="paramname">          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
displays a table of contents for the current survey session with a list of available questionnairres, the submit button, and some help text. Only show for elective aka nonT sessions 
</div>
</div><p>
<a class="anchor" name="27532bb1975d59e2f856154e6d0a5828"></a><!-- doxytag: member="SurveysController::questionnaire" ref="27532bb1975d59e2f856154e6d0a5828" args="($qr_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::questionnaire           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>qr_id</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
redirects to the first page in this qr that should be shown for the current session 
</div>
</div><p>
<a class="anchor" name="b00016d5cf4d3964ef0c5e5e70ceb8a8"></a><!-- doxytag: member="SurveysController::complete" ref="b00016d5cf4d3964ef0c5e5e70ceb8a8" args="($nth=1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::complete           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>nth</em> = <code>1</code>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="../../dc/d2c/classNote.html">Note</a> that this code is (sometimes?) not called before the view code is, e.g. when surveys/show displays a page w/ the substitution fxn "complete"<p>
Partial finalization: all data through the partial finalization step ("first stage" data) are reportable; survey session can be resumed, but answers for the first stage cannot be changed.<p>
Finalized: all data reportable; survey session cannot be resumed; answers cannot be changed<p>
This is the sequence for the end of SurveySessions, and the various states (eg finalized) each step modifies. If something is missing along this sequence, the user will exited from the survey session. <a class="el" href="../../dc/d2c/classNote.html">Note</a> that there may be survey pages between each of these steps which do not affect finalization state. surveys/show/SKIPPED_QUESTIONS_PAGE (eg #120) has substitution fxn %(skippedQuestions) traverses/constructs skipped questions return $this-&gt;controller-&gt;render('skipped_questions'); "next" button links to surveys/complete/1 if session is partially finalized, redirect to next|prev surveys/complete/1 if SINGLE_STAGE_FINALIZATION, jump to surveys/complete/2 else sets partial_finalization = true calculates instruments redirects to "/surveys/next_page/" . SKIPPED_QUESTIONS_PAGE surveys/show/COMPLETE_BTN_PAGE (eg #119) has substitution fxn %(Complete) return $this-&gt;controller-&gt;render('complete'); note that this render call will *not* cause the controller function surveys/complete to be called! the complete view has a "Complete" button which links to surveys/complete/2 surveys/complete/2 set finished = true calculates instruments redirects to an instance-specific location 
</div>
</div><p>
<a class="anchor" name="b38ccf200e576350fe9707582c35fd39"></a><!-- doxytag: member="SurveysController::copy_questionnaire" ref="b38ccf200e576350fe9707582c35fd39" args="($qnrId)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::copy_questionnaire           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>qnrId</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Copies a <a class="el" href="../../d1/dfe/classQuestionnaire.html">Questionnaire</a> and it's Pages, Questions, and Options // TODO copy conditions for which any of the above are targets. 
</div>
</div><p>
<hr><h2>Member Data Documentation</h2>
<a class="anchor" name="1fe005a75887d7ef4d9ff6f18ed110be"></a><!-- doxytag: member="SurveysController::NO_ASSOCIATED_RESULTS" ref="1fe005a75887d7ef4d9ff6f18ed110be" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../dd/d48/classSurveysController.html#1fe005a75887d7ef4d9ff6f18ed110be">SurveysController::NO_ASSOCIATED_RESULTS</a> = &quot;None&quot;          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Constant to indicate to the view that there are no results associated with the current survey page 
</div>
</div><p>
<a class="anchor" name="4fbce73d06d9dd74680413d335141731"></a><!-- doxytag: member="SurveysController::$uses" ref="4fbce73d06d9dd74680413d335141731" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::$uses          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> array(<span class="stringliteral">"SurveySession"</span>,
                      <span class="stringliteral">"Appointment"</span>,
                      <span class="stringliteral">"Project"</span>,
                      <span class="stringliteral">"Alert"</span>,
                      <span class="stringliteral">"Questionnaire"</span>,
                      <span class="stringliteral">"SessionItem"</span>,
                      <span class="stringliteral">"SessionSubscale"</span>,
                      <span class="stringliteral">"SessionScale"</span>,
                      <span class="stringliteral">"Scale"</span>,
                      <span class="stringliteral">"Subscale"</span>,
                      <span class="stringliteral">"Item"</span>,
                      <span class="stringliteral">"Page"</span>,
                      <span class="stringliteral">"Question"</span>,
                      <span class="stringliteral">"Option"</span>,
                      <span class="stringliteral">"Answer"</span>,
                      <span class="stringliteral">"Condition"</span>,
                      <span class="stringliteral">"Site"</span>,
                      <span class="stringliteral">"Clinic"</span>,
                      <span class="stringliteral">"Patient"</span>,
                      <span class="stringliteral">"User"</span>)
</pre></div>
</div>
</div><p>
<a class="anchor" name="8e5ce350dbb8b10c315e90c190bff5a2"></a><!-- doxytag: member="SurveysController::$components" ref="8e5ce350dbb8b10c315e90c190bff5a2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::$components          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>Initial value:</b><div class="fragment"><pre class="fragment"> array(
        <span class="stringliteral">'Substitution'</span>,
        <span class="stringliteral">'Conditionality'</span>,
        <span class="stringliteral">'Instruments'</span>,
        <span class="stringliteral">'TraverseSkipped'</span>,
        <span class="stringliteral">'DhairDateTime'</span>
    )
</pre></div>
</div>
</div><p>
<a class="anchor" name="a716ec94256bed5a7d767ec7ba458c9a"></a><!-- doxytag: member="SurveysController::$surveyPatientId" ref="a716ec94256bed5a7d767ec7ba458c9a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SurveysController::$surveyPatientId          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<a class="el" href="../../d2/de8/classPatient.html">Patient</a> taking the survey. May be the current user, but also may be another user if a staff member is taking the survey for a patient 
</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>/var/lib/jenkins/jobs/CPRO doc auto-generation - GitHub Repo/workspace/app/Controller/SurveysController.php</ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Dec 23 10:49:47 2013 for DHAIR2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
