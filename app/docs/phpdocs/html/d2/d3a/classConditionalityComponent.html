<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>DHAIR2: ConditionalityComponent Class Reference</title>
<link href="../../doxygen.css" rel="stylesheet" type="text/css">
<link href="../../tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="../../index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="../../namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="../../annotated.html"><span>Classes</span></a></li>
    <li>
      <form action="../../search.php" method="get">
        <table cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td><label>&nbsp;<u>S</u>earch&nbsp;for&nbsp;</label></td>
            <td><input type="text" name="query" value="" size="20" accesskey="s"/></td>
          </tr>
        </table>
      </form>
    </li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="../../annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="../../hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="../../functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>ConditionalityComponent Class Reference</h1><!-- doxytag: class="ConditionalityComponent" -->
<p>
<a href="../../de/d12/classConditionalityComponent-members.html">List of all members.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d3a/classConditionalityComponent.html#9c2166e83d344f429a4869bb35845bde">startup</a> (Controller $controller)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d3a/classConditionalityComponent.html#5e07d6e8eccda046a91b6297f161c4ef">nextLink</a> ($page_id, $session_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d3a/classConditionalityComponent.html#1a615a92579b6b91fa4fb3a1004f226c">previousLink</a> ($page_id, $session_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="a1c39c70bb76992ba20d8e4fbccc6327"></a><!-- doxytag: member="ConditionalityComponent::nextPage" ref="a1c39c70bb76992ba20d8e4fbccc6327" args="($page_id, $session)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>nextPage</b> ($page_id, $session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="68352f511b37e6218f1f7b09a380b873"></a><!-- doxytag: member="ConditionalityComponent::previousPage" ref="68352f511b37e6218f1f7b09a380b873" args="($page_id, $session)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>previousPage</b> ($page_id, $session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d3a/classConditionalityComponent.html#af143bd17d9099aa8d4f5287db081357">nextPageRecursive</a> ($current_page_id, $session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d3a/classConditionalityComponent.html#25696a7dde9f99ce82f4727c857c7389">previousPageRecursive</a> ($current_page, $session)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d3a/classConditionalityComponent.html#758fc9b0fed51f46ca13a5ab243edc99">showQr</a> ($qr_id, $session_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="7b457b149d7ccbe64b4edee2ac1fd53e"></a><!-- doxytag: member="ConditionalityComponent::showPage" ref="7b457b149d7ccbe64b4edee2ac1fd53e" args="($page_id, $session_id)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>showPage</b> ($page_id, $session_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="75ee87ee43ed394303a36cd1a71d1573"></a><!-- doxytag: member="ConditionalityComponent::getOptions" ref="75ee87ee43ed394303a36cd1a71d1573" args="($question, $session_id)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>getOptions</b> ($question, $session_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="anchor" name="00dea6800c80c3143802c1c2535783a2"></a><!-- doxytag: member="ConditionalityComponent::showOption" ref="00dea6800c80c3143802c1c2535783a2" args="($option_id, $session_id)" -->
&nbsp;</td><td class="memItemRight" valign="bottom"><b>showOption</b> ($option_id, $session_id)</td></tr>

<tr><td class="memItemLeft" nowrap align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d3a/classConditionalityComponent.html#29b0fe4bafe0d3dac0a0512012d03c64">runConditions</a> ($conditions, $session_id)</td></tr>

</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
Conditionality Component API<p>
Copyright 2013 University of Washington, School of Nursing. <a href="http://opensource.org/licenses/BSD-3-Clause">http://opensource.org/licenses/BSD-3-Clause</a><p>
The conditionality component encapsulates the logic determining whether a specific page should be shown for a session. Its basic API is accessed through the functions nextLink and previousLink. These functions should be passed the current page id and session id; they will run the conditionality rules on succeeding or previous pages until they find a page which ought to be shown, and return a cakephp link to it.<p>
Multiple conditions can be applied to a target; the default grouping is AND. To use OR instead, include a record with condition "OR" for that target.<p>
The conditionality rules have two parts: 1) function definitions wrapped in an appropriate php object, 2) records in the database's conditions table.<p>
<a class="el" href="../../df/d5f/classCondition.html">Condition</a> functions are grouped together into objects, which can be inherited from other condition function objects. They should ultimately inherit from ConditionFunctions (see documentation below), which provides the infrastructure. Functions defind inside your own ConditionFunction subclasses should: 1. Accept 2-3 arguments (the session and page id, which will be passed in autumatically, and also one other argument provided database record (see below) 2. Return true if that page should be shown, otherwise false.<p>
When these functions are called is determined by records in the database. The records contain an id, a TargetType (page or questionnaire) a target id, and a condition. If the condition is formatted like: %(checkNotFirstVisit) A function with that name is called and the target item is shown if the function returns true.<p>
If it is formatted like: %(comparisonQuestion 118 == 1) The function name in first position is called with the argument in second position. The result is then compared with the operator to the evaluated value of the item in the final position. Again, if the comparison is true, the item is shown.<p>
The value which is being compared against can be a semicolon-delimited list, e.g. 1;2;3;4. If the operand is == or ===, it's implicit OR %(comparisonQuestion 118 == 1;2;3;4) If it's anything else eg !=, &gt; etc, it's implicit AND, eg: %(comparisonField User.clinic_id != 1;2;3;4)<p>
Negations can be used by adding ! before the condition's function name eg %(!isFirstSession) Comments are provided in the source below.<p>
11/15/08 FIXME: Fails to return a sensible link if a questionnaire that should be shown does not have any pages that should be shown. (Need to add a recursive step_ <hr><h2>Member Function Documentation</h2>
<a class="anchor" name="9c2166e83d344f429a4869bb35845bde"></a><!-- doxytag: member="ConditionalityComponent::startup" ref="9c2166e83d344f429a4869bb35845bde" args="(Controller $controller)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ConditionalityComponent::startup           </td>
          <td>(</td>
          <td class="paramtype">Controller $&nbsp;</td>
          <td class="paramname"> <em>controller</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
startup: called by cakePHP automatically when included into a controller @ param AppController: current controller 
</div>
</div><p>
<a class="anchor" name="5e07d6e8eccda046a91b6297f161c4ef"></a><!-- doxytag: member="ConditionalityComponent::nextLink" ref="5e07d6e8eccda046a91b6297f161c4ef" args="($page_id, $session_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ConditionalityComponent::nextLink           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>page_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>session_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
nextLink: return a link to the next page to show in the survey <dl class="return" compact><dt><b>Returns:</b></dt><dd>string: cakephp url to the next page. </dd></dl>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>$page_id: id of the current page. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>$session_id: id of the current session </td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="1a615a92579b6b91fa4fb3a1004f226c"></a><!-- doxytag: member="ConditionalityComponent::previousLink" ref="1a615a92579b6b91fa4fb3a1004f226c" args="($page_id, $session_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ConditionalityComponent::previousLink           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>page_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>session_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
previousLink: returns a link to the previous page to show in the survey session <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>$page_id </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>int</em>&nbsp;</td><td>$session_id </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>string: cakephp url </dd></dl>

</div>
</div><p>
<a class="anchor" name="af143bd17d9099aa8d4f5287db081357"></a><!-- doxytag: member="ConditionalityComponent::nextPageRecursive" ref="af143bd17d9099aa8d4f5287db081357" args="($current_page_id, $session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ConditionalityComponent::nextPageRecursive           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>current_page_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>session</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Given a page, see if we should show it. If not, try the function again on the next one. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$current_page_id,:</em>&nbsp;</td><td>id of the page where we start looking; if null, start at the project's first page. </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$session,the</em>&nbsp;</td><td>array for the current session </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>id of next page to show, or null if no more pages in survey </dd></dl>

</div>
</div><p>
<a class="anchor" name="25696a7dde9f99ce82f4727c857c7389"></a><!-- doxytag: member="ConditionalityComponent::previousPageRecursive" ref="25696a7dde9f99ce82f4727c857c7389" args="($current_page, $session)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ConditionalityComponent::previousPageRecursive           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>current_page</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>session</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$current_page_id</em>&nbsp;</td><td></td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$session</em>&nbsp;</td><td></td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>int id of the previous page to show </dd></dl>

</div>
</div><p>
<a class="anchor" name="758fc9b0fed51f46ca13a5ab243edc99"></a><!-- doxytag: member="ConditionalityComponent::showQr" ref="758fc9b0fed51f46ca13a5ab243edc99" args="($qr_id, $session_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ConditionalityComponent::showQr           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>qr_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>session_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$qr_id</em>&nbsp;</td><td>: id of the questionnaire to be checked </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$session_id</em>&nbsp;</td><td>: id of the session to check for </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>bool : true if it should be shown, else false </dd></dl>

</div>
</div><p>
<a class="anchor" name="29b0fe4bafe0d3dac0a0512012d03c64"></a><!-- doxytag: member="ConditionalityComponent::runConditions" ref="29b0fe4bafe0d3dac0a0512012d03c64" args="($conditions, $session_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ConditionalityComponent::runConditions           </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>conditions</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>session_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
By default: all conditions must be met (i.e. AND) If condition 'OR' exists for this target, meeting any of the conditions for the target suffices 
</div>
</div><p>
<hr>The documentation for this class was generated from the following file:<ul>
<li>/var/lib/jenkins/jobs/CPRO doc auto-generation - GitHub Repo/workspace/app/Controller/Component/ConditionalityComponent.php</ul>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Dec 23 10:49:47 2013 for DHAIR2 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="../../doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
